import{c as h,r as o,u as B,j as e,m as l,A as D,U as O,i as F,L as H,y as _,z as q,E as u,F as G,G as j,e as w,H as z,I,J as $,K as J,M as V,N as K,O as Q}from"./index-SgyLPKfI.js";import{L as X}from"./lock-Ht2E98cV.js";const Y=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],Z=h("eye-off",Y);const ee=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],te=h("eye",ee);const ae=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ie=h("mail",ae);const se=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],N=h("shield",se);function ne(){const[s,A]=o.useState("signin"),[p,R]=o.useState(""),[m,E]=o.useState(""),[g,M]=o.useState(""),[x,P]=o.useState(""),[f,L]=o.useState(!1),[d,c]=o.useState(!1),[k,n]=o.useState(""),[S,b]=o.useState(""),{setUser:v}=B(),U=async()=>{c(!0),n("");try{const i=(await q(u,G)).user,a=j(w,"users",i.uid);if(!(await z(a)).exists()){const C=i.email?i.email.split("@")[0]:`user_${i.uid.slice(0,8)}`,T={name:i.displayName||"User",username:C,level:1,xp:0,xpToNextLevel:500,totalTasksCompleted:0,currentStreak:0,longestStreak:0,lastActiveDate:new Date().toISOString().split("T")[0],joinedDate:new Date().toISOString(),badges:[],dailyChallenge:null,preferences:{theme:"dark",celebrationsEnabled:!0,soundEnabled:!0,defaultHorizon:"daily",defaultPriority:"medium",accentColor:"#7c6cf0",autoRollover:!0,rolloverMultiplier:!0},onboardingComplete:!0};await I(a,{uid:i.uid,email:i.email,name:i.displayName||"User",photoURL:i.photoURL,username:C,createdAt:new Date().toISOString(),onboardingComplete:!0,profile:T,tasks:[],completionHistory:[]})}v(i)}catch(t){console.error(t),t.code==="auth/popup-closed-by-user"?n("Sign-in cancelled."):n("Failed to sign in with Google.")}finally{c(!1)}},W=async t=>{t.preventDefault(),c(!0),n(""),b("");try{if(s==="signup"){const a=(await $(u,p,m)).user;await J(a,{displayName:g});const r={name:g,username:x,level:1,xp:0,xpToNextLevel:500,totalTasksCompleted:0,currentStreak:0,longestStreak:0,lastActiveDate:new Date().toISOString().split("T")[0],joinedDate:new Date().toISOString(),badges:[],dailyChallenge:null,preferences:{theme:"dark",celebrationsEnabled:!0,soundEnabled:!0,defaultHorizon:"daily",defaultPriority:"medium",accentColor:"#7c6cf0",autoRollover:!0,rolloverMultiplier:!0},onboardingComplete:!0};await I(j(w,"users",a.uid),{uid:a.uid,email:a.email,name:g,photoURL:a.photoURL,username:x,createdAt:new Date().toISOString(),onboardingComplete:!0,profile:r,tasks:[],completionHistory:[]}),v(a)}else if(s==="signin"){const i=await V(u,p,m),a=j(w,"users",i.user.uid);if(!(await z(a)).exists()){await K(u),n("Account does not exist. Please sign up first.");return}v(i.user)}else if(s==="forgot-password"){await Q(u,p),b("Password reset email sent! Check your inbox."),c(!1);return}}catch(i){console.error(i);const a=i.code;let r="Authentication failed.";a==="auth/email-already-in-use"?r="Email is already in use.":a==="auth/invalid-email"?r="Invalid email address.":a==="auth/weak-password"?r="Password should be at least 6 characters.":a==="auth/user-not-found"?r="No account found with this email.":a==="auth/wrong-password"?r="Incorrect password.":a==="auth/too-many-requests"?r="Too many attempts. Try again later.":a==="auth/invalid-credential"&&(r="Invalid credentials."),n(r)}finally{c(!1)}},y=t=>{A(t),n(""),b("")};return e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--gradient-bg)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{className:"mesh-background",style:{opacity:.6}}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},style:{width:"100%",maxWidth:440,padding:20,zIndex:10},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:32},children:[e.jsxs(l.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},style:{width:64,height:64,margin:"0 auto 16px",background:"linear-gradient(135deg, #6C5CE7 0%, #4A3DB8 100%)",borderRadius:16,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px rgba(108, 92, 231, 0.3)",position:"relative"},children:[e.jsx(N,{size:32,color:"white",fill:"rgba(255,255,255,0.2)",strokeWidth:2.5}),e.jsx("div",{style:{position:"absolute",inset:-2,borderRadius:18,background:"linear-gradient(135deg, rgba(255,255,255,0.4), transparent)",zIndex:-1,opacity:.5}})]}),e.jsx(l.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},style:{fontSize:28,fontWeight:900,background:"linear-gradient(to right, #fff, #a5a6c2)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:8,letterSpacing:"-0.5px"},children:"Attackers Arena"}),e.jsx(l.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},style:{color:"var(--text-tertiary)",fontSize:14},children:s==="signin"?"Sign in to access your missions":s==="signup"?"Join the arena and start winning":"Recover your account access"})]}),e.jsxs("div",{style:{background:"rgba(12, 12, 20, 0.7)",backdropFilter:"blur(20px)",border:"1px solid var(--border-medium)",borderRadius:24,padding:"32px 28px",boxShadow:"0 16px 40px rgba(0,0,0,0.4)"},children:[e.jsxs("form",{onSubmit:W,children:[e.jsx(D,{mode:"wait",children:s==="signup"&&e.jsxs(l.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:[e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(O,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Full Name",value:g,onChange:t=>M(t.target.value),required:s==="signup",style:{paddingLeft:42,width:"100%"}})]})}),e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)",fontWeight:"bold"},children:"@"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Username",value:x,onChange:t=>P(t.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")),required:s==="signup",style:{paddingLeft:42,width:"100%"}})]})})]},"name")}),e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(ie,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:"email",className:"form-input",placeholder:"Email Address",value:p,onChange:t=>R(t.target.value),required:!0,style:{paddingLeft:42,width:"100%"}})]})}),s!=="forgot-password"&&e.jsx("div",{className:"form-group",style:{marginBottom:s==="signin"?8:20},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(X,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:f?"text":"password",className:"form-input",placeholder:"Password",value:m,onChange:t=>E(t.target.value),required:!0,style:{paddingLeft:42,paddingRight:42,width:"100%"}}),e.jsx("button",{type:"button",onClick:()=>L(!f),style:{position:"absolute",top:12,right:12,background:"none",border:"none",cursor:"pointer",color:"var(--text-tertiary)"},children:f?e.jsx(Z,{size:18}):e.jsx(te,{size:18})})]})}),s==="signin"&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:20},children:e.jsx("button",{type:"button",onClick:()=>y("forgot-password"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontSize:13,fontWeight:500,cursor:"pointer"},children:"Forgot Password?"})}),k&&e.jsxs(l.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},style:{marginBottom:16,padding:"10px 14px",borderRadius:8,background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.2)",color:"var(--accent-danger)",fontSize:13,display:"flex",alignItems:"center",gap:8},children:[e.jsx(F,{size:14})," ",k]}),S&&e.jsx(l.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},style:{marginBottom:16,padding:"10px 14px",borderRadius:8,background:"rgba(0, 214, 143, 0.1)",border:"1px solid rgba(0, 214, 143, 0.2)",color:"var(--accent-success)",fontSize:13},children:S}),e.jsx("button",{type:"submit",disabled:d,className:"btn",style:{width:"100%",background:"var(--gradient-primary)",color:"white",padding:"12px",borderRadius:12,fontWeight:600,border:"none",cursor:d?"wait":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8,boxShadow:"0 4px 12px rgba(124, 108, 240, 0.3)",transition:"all 0.2s",opacity:d?.7:1},children:d?e.jsx(H,{size:18,className:"animate-spin"}):s==="signin"?"Sign In":s==="signup"?"Create Account":"Send Reset Link"})]}),s!=="forgot-password"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"24px 0",gap:12},children:[e.jsx("div",{style:{height:1,flex:1,background:"var(--border-subtle)"}}),e.jsx("span",{style:{fontSize:12,color:"var(--text-tertiary)",fontWeight:500},children:"OR CONTINUE WITH"}),e.jsx("div",{style:{height:1,flex:1,background:"var(--border-subtle)"}})]}),e.jsxs("button",{onClick:U,disabled:d,style:{width:"100%",background:"rgba(255, 255, 255, 0.05)",color:"var(--text-primary)",padding:"12px",borderRadius:12,fontWeight:600,border:"1px solid var(--border-subtle)",cursor:d?"wait":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10,transition:"all 0.2s"},onMouseOver:t=>t.currentTarget.style.background="rgba(255, 255, 255, 0.08)",onMouseOut:t=>t.currentTarget.style.background="rgba(255, 255, 255, 0.05)",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),e.jsx("div",{style:{marginTop:24,textAlign:"center",fontSize:14},children:s==="signin"?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"var(--text-tertiary)"},children:"Don't have an account? "}),e.jsx("button",{onClick:()=>y("signup"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer"},children:"Sign Up"})]}):s==="signup"?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"var(--text-tertiary)"},children:"Already have an account? "}),e.jsx("button",{onClick:()=>y("signin"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer"},children:"Sign In"})]}):e.jsxs("button",{onClick:()=>y("signin"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,margin:"0 auto"},children:[e.jsx(_,{size:14,style:{transform:"rotate(180deg)"}})," Back to Sign In"]})})]}),e.jsxs("div",{style:{marginTop:32,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:6,opacity:.5,fontSize:12,color:"var(--text-tertiary)"},children:[e.jsx(N,{size:12}),"Secured by Firebase"]})]})]})}export{ne as default};
