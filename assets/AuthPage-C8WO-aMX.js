import{j as e,m as l,A as D}from"./vendor-react-dE8-2NoN.js";import{r as o,a1 as C,U as L,a2 as M,a0 as O,a3 as F,a4 as H,T as q,G,A as V}from"./vendor-ui-Bq2TQ6SB.js";import{u as _,a as u,b as J,d as v}from"./index-CEuaEbzT.js";import{n as $,d as j,j as z,s as I,p as K,u as Q,r as X,t as Y,l as Z,v as ee}from"./vendor-firebase-25KR_2Xm.js";import"./vendor-charts-B_b_m-Bk.js";function oe(){const[s,A]=o.useState("signin"),[p,R]=o.useState(""),[y,N]=o.useState(""),[g,E]=o.useState(""),[h,P]=o.useState(""),[x,T]=o.useState(!1),[d,c]=o.useState(!1),[w,n]=o.useState(""),[S,f]=o.useState(""),{setUser:b}=_(),U=async()=>{c(!0),n("");try{const i=(await $(u,J)).user,t=j(v,"users",i.uid);if(!(await z(t)).exists()){const k=i.email?i.email.split("@")[0]:`user_${i.uid.slice(0,8)}`,B={name:i.displayName||"User",username:k,level:1,xp:0,xpToNextLevel:500,totalTasksCompleted:0,currentStreak:0,longestStreak:0,lastActiveDate:new Date().toISOString().split("T")[0],joinedDate:new Date().toISOString(),badges:[],dailyChallenge:null,preferences:{theme:"dark",celebrationsEnabled:!0,soundEnabled:!0,defaultHorizon:"daily",defaultPriority:"medium",accentColor:"#7c6cf0",autoRollover:!0,rolloverMultiplier:!0},onboardingComplete:!0};await I(t,{uid:i.uid,email:i.email,name:i.displayName||"User",photoURL:i.photoURL,username:k,createdAt:new Date().toISOString(),onboardingComplete:!0,profile:B,templates:[],instances:[],completionHistory:[]})}b(i)}catch(a){console.error(a),a.code==="auth/popup-closed-by-user"?n("Sign-in cancelled."):n("Failed to sign in with Google.")}finally{c(!1)}},W=async a=>{a.preventDefault(),c(!0),n(""),f("");try{if(s==="signup"){const t=(await K(u,p,y)).user;await Q(t,{displayName:g});const r={name:g,username:h,level:1,xp:0,xpToNextLevel:500,totalTasksCompleted:0,currentStreak:0,longestStreak:0,lastActiveDate:new Date().toISOString().split("T")[0],joinedDate:new Date().toISOString(),badges:[],dailyChallenge:null,preferences:{theme:"dark",celebrationsEnabled:!0,soundEnabled:!0,defaultHorizon:"daily",defaultPriority:"medium",accentColor:"#7c6cf0",autoRollover:!0,rolloverMultiplier:!0},onboardingComplete:!0};await I(j(v,"users",t.uid),{uid:t.uid,email:t.email,name:g,photoURL:t.photoURL,username:h,createdAt:new Date().toISOString(),onboardingComplete:!0,profile:r,templates:[],instances:[],completionHistory:[]}),await X(t),b(t)}else if(s==="signin"){const i=await Y(u,p,y),t=j(v,"users",i.user.uid);if(!(await z(t)).exists()){await Z(u),n("Account does not exist. Please sign up first.");return}b(i.user)}else if(s==="forgot-password"){await ee(u,p),f("Password reset email sent! Check your inbox."),c(!1);return}}catch(i){console.error(i);const t=i.code;let r="Authentication failed.";t==="auth/email-already-in-use"?r="Email is already in use.":t==="auth/invalid-email"?r="Invalid email address.":t==="auth/weak-password"?r="Password should be at least 6 characters.":t==="auth/user-not-found"?r="No account found with this email.":t==="auth/wrong-password"?r="Incorrect password.":t==="auth/too-many-requests"?r="Too many attempts. Try again later.":t==="auth/invalid-credential"&&(r="Invalid credentials."),n(r)}finally{c(!1)}},m=a=>{A(a),n(""),f("")};return e.jsxs("div",{style:{minHeight:"100vh",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--gradient-bg)",position:"relative",overflow:"hidden"},children:[e.jsx("div",{className:"mesh-background",style:{opacity:.6}}),e.jsxs(l.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6,ease:[.22,1,.36,1]},style:{width:"100%",maxWidth:440,padding:20,zIndex:10},children:[e.jsxs("div",{style:{textAlign:"center",marginBottom:32},children:[e.jsxs(l.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},style:{width:64,height:64,margin:"0 auto 16px",background:"linear-gradient(135deg, #6C5CE7 0%, #4A3DB8 100%)",borderRadius:16,display:"flex",alignItems:"center",justifyContent:"center",boxShadow:"0 8px 32px rgba(108, 92, 231, 0.3)",position:"relative"},children:[e.jsx(C,{size:32,color:"white",fill:"rgba(255,255,255,0.2)",strokeWidth:2.5}),e.jsx("div",{style:{position:"absolute",inset:-2,borderRadius:18,background:"linear-gradient(135deg, rgba(255,255,255,0.4), transparent)",zIndex:-1,opacity:.5}})]}),e.jsx(l.h1,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.3},style:{fontSize:28,fontWeight:900,background:"linear-gradient(to right, #fff, #a5a6c2)",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent",marginBottom:8,letterSpacing:"-0.5px"},children:"Attackers Arena"}),e.jsx(l.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},style:{color:"var(--text-tertiary)",fontSize:14},children:s==="signin"?"Sign in to access your missions":s==="signup"?"Join the arena and start winning":"Recover your account access"})]}),e.jsxs("div",{style:{background:"rgba(12, 12, 20, 0.7)",backdropFilter:"blur(20px)",border:"1px solid var(--border-medium)",borderRadius:24,padding:"32px 28px",boxShadow:"0 16px 40px rgba(0,0,0,0.4)"},children:[e.jsxs("form",{onSubmit:W,children:[e.jsx(D,{mode:"wait",children:s==="signup"&&e.jsxs(l.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},style:{overflow:"hidden"},children:[e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(L,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Full Name",value:g,onChange:a=>E(a.target.value),required:s==="signup",style:{paddingLeft:42,width:"100%"}})]})}),e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx("span",{style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)",fontWeight:"bold"},children:"@"}),e.jsx("input",{type:"text",className:"form-input",placeholder:"Username",value:h,onChange:a=>P(a.target.value.toLowerCase().replace(/[^a-z0-9_]/g,"")),required:s==="signup",style:{paddingLeft:42,width:"100%"}})]})})]},"name")}),e.jsx("div",{className:"form-group",style:{marginBottom:16},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(M,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:"email",className:"form-input",placeholder:"Email Address",value:p,onChange:a=>R(a.target.value),required:!0,style:{paddingLeft:42,width:"100%"}})]})}),s!=="forgot-password"&&e.jsx("div",{className:"form-group",style:{marginBottom:s==="signin"?8:20},children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(O,{size:18,style:{position:"absolute",top:12,left:14,color:"var(--text-tertiary)"}}),e.jsx("input",{type:x?"text":"password",className:"form-input",placeholder:"Password",value:y,onChange:a=>N(a.target.value),required:!0,style:{paddingLeft:42,paddingRight:42,width:"100%"}}),e.jsx("button",{type:"button",onClick:()=>T(!x),style:{position:"absolute",top:12,right:12,background:"none",border:"none",cursor:"pointer",color:"var(--text-tertiary)"},children:x?e.jsx(F,{size:18}):e.jsx(H,{size:18})})]})}),s==="signin"&&e.jsx("div",{style:{display:"flex",justifyContent:"flex-end",marginBottom:20},children:e.jsx("button",{type:"button",onClick:()=>m("forgot-password"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontSize:13,fontWeight:500,cursor:"pointer"},children:"Forgot Password?"})}),w&&e.jsxs(l.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},style:{marginBottom:16,padding:"10px 14px",borderRadius:8,background:"rgba(255, 107, 107, 0.1)",border:"1px solid rgba(255, 107, 107, 0.2)",color:"var(--accent-danger)",fontSize:13,display:"flex",alignItems:"center",gap:8},children:[e.jsx(q,{size:14})," ",w]}),S&&e.jsx(l.div,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},style:{marginBottom:16,padding:"10px 14px",borderRadius:8,background:"rgba(0, 214, 143, 0.1)",border:"1px solid rgba(0, 214, 143, 0.2)",color:"var(--accent-success)",fontSize:13},children:S}),e.jsx("button",{type:"submit",disabled:d,className:"btn",style:{width:"100%",background:"var(--gradient-primary)",color:"white",padding:"12px",borderRadius:12,fontWeight:600,border:"none",cursor:d?"wait":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:8,boxShadow:"0 4px 12px rgba(124, 108, 240, 0.3)",transition:"all 0.2s",opacity:d?.7:1},children:d?e.jsx(G,{size:18,className:"animate-spin"}):s==="signin"?"Sign In":s==="signup"?"Create Account":"Send Reset Link"})]}),s!=="forgot-password"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{display:"flex",alignItems:"center",margin:"24px 0",gap:12},children:[e.jsx("div",{style:{height:1,flex:1,background:"var(--border-subtle)"}}),e.jsx("span",{style:{fontSize:12,color:"var(--text-tertiary)",fontWeight:500},children:"OR CONTINUE WITH"}),e.jsx("div",{style:{height:1,flex:1,background:"var(--border-subtle)"}})]}),e.jsxs("button",{onClick:U,disabled:d,style:{width:"100%",background:"rgba(255, 255, 255, 0.05)",color:"var(--text-primary)",padding:"12px",borderRadius:12,fontWeight:600,border:"1px solid var(--border-subtle)",cursor:d?"wait":"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:10,transition:"all 0.2s"},onMouseOver:a=>a.currentTarget.style.background="rgba(255, 255, 255, 0.08)",onMouseOut:a=>a.currentTarget.style.background="rgba(255, 255, 255, 0.05)",children:[e.jsxs("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[e.jsx("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),e.jsx("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),e.jsx("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),e.jsx("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),"Google"]})]}),e.jsx("div",{style:{marginTop:24,textAlign:"center",fontSize:14},children:s==="signin"?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"var(--text-tertiary)"},children:"Don't have an account? "}),e.jsx("button",{onClick:()=>m("signup"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer"},children:"Sign Up"})]}):s==="signup"?e.jsxs(e.Fragment,{children:[e.jsx("span",{style:{color:"var(--text-tertiary)"},children:"Already have an account? "}),e.jsx("button",{onClick:()=>m("signin"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer"},children:"Sign In"})]}):e.jsxs("button",{onClick:()=>m("signin"),style:{background:"none",border:"none",color:"var(--accent-primary)",fontWeight:600,cursor:"pointer",display:"flex",alignItems:"center",justifyContent:"center",gap:6,margin:"0 auto"},children:[e.jsx(V,{size:14,style:{transform:"rotate(180deg)"}})," Back to Sign In"]})})]}),e.jsxs("div",{style:{marginTop:32,textAlign:"center",display:"flex",alignItems:"center",justifyContent:"center",gap:6,opacity:.5,fontSize:12,color:"var(--text-tertiary)"},children:[e.jsx(C,{size:12}),"Secured by Firebase"]})]})]})}export{oe as default};
