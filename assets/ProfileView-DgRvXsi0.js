import{j as e,m as i,A as W}from"./vendor-react-dE8-2NoN.js";import{r as n,a5 as A,n as E,G as I,a6 as B,m as D,F,w as U,a7 as M,a8 as V,L as Y}from"./vendor-ui-Bq2TQ6SB.js";import{u as v,d as O,a as X}from"./index-CEuaEbzT.js";import{u as G,d as H,x as $,l as q}from"./vendor-firebase-25KR_2Xm.js";import"./vendor-charts-B_b_m-Bk.js";const J=t=>t>=50?"Grandmaster":t>=30?"Legend":t>=20?"Master":t>=10?"Expert":t>=5?"Achiever":"Aspirant",j=["Every task completed is a step closer to your dreams.","Consistency is the key to unlocking your potential.","Small progress is still progress.","You are capable of amazing things.","Focus on being productive instead of busy.","The future depends on what you do today."];function te(){const{user:t,setUser:x,profile:s,getProductivityScore:b}=v(),[r,g]=n.useState(t?.displayName||""),[m,u]=n.useState(!1),[c,o]=n.useState(""),[y,p]=n.useState(!1),[N,h]=n.useState(!1),[S,k]=n.useState(!1),[w]=n.useState(j[Math.floor(Math.random()*j.length)]);n.useEffect(()=>{t&&g(t.displayName||"")},[t]);const C=async a=>{if(a.preventDefault(),!!t){u(!0),o("");try{t.displayName!==r&&await G(t,{displayName:r});const d=H(O,"users",t.uid);await $(d,{"profile.name":r}),x({...t,displayName:r}),v.setState(f=>({...f,profile:{...f.profile,name:r}})),o("Profile updated successfully!"),setTimeout(()=>{o(""),p(!1)},1e3)}catch(d){console.error(d),o(`Failed to update: ${d.message}`)}finally{u(!1)}}},z=async()=>{try{await q(X),x(null)}catch(a){console.error("Error signing out: ",a)}};if(!t)return null;const T=J(s.level),L=Math.min(100,s.xp/s.xpToNextLevel*100),R=b(),P={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},l={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}};return e.jsxs("div",{className:"view-container",style:{paddingBottom:80},children:[e.jsxs(i.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"profile-header",style:{marginBottom:32,textAlign:"center"},children:[e.jsx(i.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.2},style:{marginBottom:12},children:e.jsx("span",{style:{fontSize:12,fontWeight:700,letterSpacing:2,textTransform:"uppercase",color:"var(--accent-primary)",background:"rgba(124, 108, 240, 0.1)",padding:"6px 16px",borderRadius:20},children:"Your Journey"})}),e.jsxs("h1",{style:{fontSize:32,fontWeight:800,marginBottom:8},children:["Hello, ",e.jsx("span",{style:{background:"var(--gradient-primary)",backgroundClip:"text",WebkitBackgroundClip:"text",WebkitTextFillColor:"transparent"},children:r||"Traveler"})]}),e.jsxs("p",{style:{color:"var(--text-secondary)",fontSize:15,maxWidth:500,margin:"0 auto",fontStyle:"italic"},children:['"',w,'"']})]}),e.jsxs(i.div,{variants:P,initial:"hidden",animate:"visible",style:{maxWidth:900,margin:"0 auto",display:"flex",flexDirection:"column",gap:24},children:[e.jsx(i.div,{variants:l,className:"card",style:{padding:0,overflow:"hidden",background:"linear-gradient(135deg, rgba(8,8,16,0.8), rgba(20,20,35,0.9))",border:"1px solid var(--border-medium)"},children:e.jsxs("div",{className:"profile-hero-content",style:{display:"flex",flexWrap:"wrap"},children:[e.jsxs("div",{style:{padding:32,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",background:"rgba(255,255,255,0.02)",borderRight:"1px solid var(--border-subtle)",position:"relative",minWidth:260,flex:"1 1 260px"},children:[e.jsx("div",{style:{position:"relative"},children:e.jsx("div",{style:{width:100,height:100,borderRadius:"50%",background:"var(--bg-secondary)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:40,fontWeight:"bold",color:"white",position:"relative",zIndex:1,border:"4px solid rgba(255,255,255,0.1)",overflow:"hidden"},children:t.photoURL&&!S?e.jsx("img",{src:t.photoURL,alt:"Profile",onError:()=>k(!0),style:{width:"100%",height:"100%",objectFit:"cover"}}):(r?.[0]||"U").toUpperCase()})}),e.jsxs("div",{style:{marginTop:16,textAlign:"center"},children:[e.jsx("div",{style:{fontSize:18,fontWeight:700},children:r}),s.username&&e.jsxs("div",{style:{fontSize:13,color:"var(--accent-primary)",fontWeight:600},children:["@",s.username]}),e.jsx("div",{style:{fontSize:13,color:"var(--text-tertiary)"},children:t.email})]}),e.jsxs("button",{onClick:()=>p(!y),style:{marginTop:20,display:"flex",alignItems:"center",gap:6,background:"rgba(255,255,255,0.05)",border:"1px solid var(--border-subtle)",padding:"8px 16px",borderRadius:20,fontSize:12,color:"var(--text-secondary)",cursor:"pointer",transition:"all 0.2s"},children:[e.jsx(A,{size:12})," Edit Profile"]})]}),e.jsxs("div",{style:{flex:"1 1 300px",padding:32,display:"flex",flexDirection:"column",justifyContent:"center"},children:[e.jsxs("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"flex-start",marginBottom:24},children:[e.jsxs("div",{children:[e.jsx("h3",{style:{fontSize:14,color:"var(--text-tertiary)",textTransform:"uppercase",letterSpacing:1},children:"Current Rank"}),e.jsxs("div",{style:{fontSize:36,fontWeight:900,color:"white",display:"flex",alignItems:"center",gap:12},children:[T,e.jsxs("span",{style:{fontSize:14,background:"var(--accent-warning)",color:"black",padding:"2px 8px",borderRadius:4,fontWeight:800},children:["LVL ",s.level]})]})]}),e.jsx(E,{size:48,color:"var(--accent-warning)",style:{opacity:.8}})]}),e.jsxs("div",{style:{marginBottom:8,display:"flex",justifyContent:"space-between",fontSize:13,fontWeight:600},children:[e.jsxs("span",{style:{color:"var(--accent-primary)"},children:[s.xp," XP"]}),e.jsxs("span",{style:{color:"var(--text-tertiary)"},children:[s.xpToNextLevel," XP to Level ",s.level+1]})]}),e.jsx("div",{style:{height:12,background:"rgba(255,255,255,0.05)",borderRadius:6,overflow:"hidden",border:"1px solid var(--border-subtle)",position:"relative"},children:e.jsx(i.div,{initial:{width:0},animate:{width:`${L}%`},transition:{duration:1.5,ease:"easeOut"},style:{height:"100%",background:"var(--gradient-primary)",borderRadius:6,boxShadow:"0 0 10px var(--accent-primary-glow)"}})}),e.jsx("p",{style:{marginTop:12,fontSize:13,color:"var(--text-secondary)",lineHeight:1.5},children:"Keep completing tasks to earn XP and unlock new ranks. You are doing great!"})]})]})}),e.jsx(W,{children:y&&e.jsx(i.div,{initial:{opacity:0,height:0,overflow:"hidden"},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},style:{overflow:"hidden"},children:e.jsxs("div",{className:"card",style:{padding:24,border:"1px solid var(--accent-primary)",background:"rgba(124, 108, 240, 0.05)"},children:[e.jsxs("form",{onSubmit:C,style:{display:"flex",gap:16,alignItems:"center"},children:[e.jsxs("div",{style:{flex:1},children:[e.jsx("label",{style:{display:"block",fontSize:12,marginBottom:6,color:"var(--text-secondary)"},children:"Display Name"}),e.jsx("input",{type:"text",value:r,onChange:a=>g(a.target.value),className:"form-input",style:{width:"100%"}})]}),e.jsxs("div",{style:{display:"flex",gap:8,marginTop:22},children:[e.jsxs("button",{type:"submit",className:"btn btn-primary",disabled:m,children:[m?e.jsx(I,{size:16,className:"spin"}):e.jsx(B,{size:16})," Save"]}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"btn btn-secondary",children:"Cancel"})]})]}),c&&e.jsx("div",{style:{marginTop:12,fontSize:13,color:c.includes("Failed")?"var(--accent-danger)":"var(--accent-success)"},children:c})]})})}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:16},children:[e.jsxs(i.div,{variants:l,className:"stat-card purple",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(D,{})}),e.jsx("div",{className:"stat-card-value",children:s.totalTasksCompleted}),e.jsx("div",{className:"stat-card-label",children:"Total Tasks Completed"})]}),e.jsxs(i.div,{variants:l,className:"stat-card orange",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(F,{})}),e.jsx("div",{className:"stat-card-value",children:s.currentStreak}),e.jsx("div",{className:"stat-card-label",children:"Day Streak"})]}),e.jsxs(i.div,{variants:l,className:"stat-card teal",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(U,{})}),e.jsxs("div",{className:"stat-card-value",children:[R,"%"]}),e.jsx("div",{className:"stat-card-label",children:"Productivity Score"})]}),e.jsxs(i.div,{variants:l,className:"stat-card pink",children:[e.jsx("div",{className:"stat-card-icon",children:e.jsx(M,{})}),e.jsx("div",{className:"stat-card-value",children:s.badges.filter(a=>a.unlockedAt).length}),e.jsx("div",{className:"stat-card-label",children:"Badges Earned"})]})]}),e.jsxs(i.div,{variants:l,className:"card",children:[e.jsx("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:16},children:e.jsxs("h3",{className:"card-title",style:{display:"flex",alignItems:"center",gap:8},children:[e.jsx(V,{size:18,color:"var(--accent-warning)"})," Recent Achievements"]})}),e.jsxs("div",{className:"badge-grid",style:{gridTemplateColumns:"repeat(auto-fill, minmax(140px, 1fr))"},children:[s.badges.filter(a=>a.unlockedAt).slice(-4).map(a=>e.jsxs("div",{className:"badge-card unlocked",style:{padding:16},children:[e.jsx("div",{className:"badge-icon",style:{fontSize:32},children:a.icon}),e.jsx("div",{className:"badge-name",style:{fontSize:12},children:a.name})]},a.id)),s.badges.filter(a=>a.unlockedAt).length===0&&e.jsx("div",{style:{gridColumn:"1/-1",textAlign:"center",color:"var(--text-tertiary)",padding:20},children:"No badges earned yet. Start completing tasks!"})]})]}),e.jsx(i.div,{variants:l,style:{display:"flex",justifyContent:"center",marginTop:16},children:N?e.jsxs("div",{style:{display:"flex",gap:12,alignItems:"center",background:"var(--bg-card)",padding:8,borderRadius:12,border:"1px solid var(--border-medium)"},children:[e.jsx("span",{style:{fontSize:14,padding:"0 8px"},children:"Are you sure?"}),e.jsx("button",{onClick:z,className:"btn btn-danger",style:{padding:"6px 16px"},children:"Yes, Logout"}),e.jsx("button",{onClick:()=>h(!1),className:"btn btn-secondary",style:{padding:"6px 16px"},children:"Cancel"})]}):e.jsxs("button",{onClick:()=>h(!0),className:"btn",style:{color:"var(--text-tertiary)",background:"transparent",display:"flex",alignItems:"center",gap:8},children:[e.jsx(Y,{size:16})," Logout"]})})]})]})}export{te as default};
